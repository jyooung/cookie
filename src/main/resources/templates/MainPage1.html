<!-- 데이터 전달만 완료 -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Personal Follower</title>
    <link rel="stylesheet" href="/css/MainPageCss.css">
    <link href="https://fonts.googleapis.com/css?family=Actor&display=swap" rel="stylesheet">
</head>
<body>
<div class="wrap">
    <span class="logo">personal follower</span>
    <div class="main_sign">
        <div class="sign_img"></div>
        <span class="sign_text"><span class="user_id">jyooung</span>님의 관심 카테고리를 보여드릴게요!</span>
    </div>
    <div class="search">
        <div class="search-text">카테고리 키워드를 검색해보세요</div>
        <div class="search_logo"></div>
    </div>
    <div class="cate_massage_container">
        <div class="cate_message">1개월 동안의 20개의 카테고리에 관심이 있으셨군요!</div>
    </div>

    <!-- 상위 카테고리 네비게이션 -->
    <div class="category-navigation">
        <div th:each="category : ${categoriesData}"
             class="category-button"
             th:text="${category.categoryName}"
             th:data-category="${category.categoryName}">
        </div>
    </div>

    <!-- 하위 카테고리 컨테이너 -->
    <div id="sub-category-container" class="sub-category-container" style="display: flex;">
        <!-- 하위 카테고리 버튼이 여기에 동적으로 추가됩니다 -->
    </div>

    <!-- 콘텐츠 영역 -->
    <div id="content-container" style="display: flex; gap: 10px; flex-wrap: wrap;">
        <!-- 하위 카테고리를 클릭했을 때 콘텐츠가 여기에 동적으로 추가됩니다 -->
    </div>

</div>

<!-- 자바스크립트 -->
<!-- 자바스크립트 -->
<script th:inline="javascript">
    document.addEventListener("DOMContentLoaded", function() {
        const categoryButtons = document.querySelectorAll('.category-button');
        const subCategoryContainer = document.getElementById("sub-category-container");

        // Thymeleaf를 통해 전달된 데이터 바인딩
        const categoriesData = /*[[${categories}]]*/ [];

        console.log(categoriesData);  // categoriesData를 콘솔에 출력하여 값 확인

        // 하위 카테고리를 업데이트하는 함수
        function updateSubCategories(categoryName) {
            subCategoryContainer.innerHTML = '';  // 기존 하위 카테고리 지우기

            const selectedCategory = categoriesData.find(category => category.categoryName === categoryName);
            const subCategories = selectedCategory ? selectedCategory.subCategories : [];

            subCategories.forEach(subCategory => {
                const subCategoryDiv = document.createElement("div");
                subCategoryDiv.className = "sub-category-button";
                subCategoryDiv.textContent = subCategory.subCategoryName;
                subCategoryContainer.appendChild(subCategoryDiv);

                // 하위 카테고리 버튼 클릭 이벤트 리스너 추가
                subCategoryDiv.addEventListener("click", function() {
                    document.querySelectorAll('.sub-category-button').forEach(btn => btn.classList.remove('selected-sub-category'));
                    subCategoryDiv.classList.add('selected-sub-category');
                    updateContent(subCategory.contents);
                });
            });
        }

        categoryButtons.forEach(button => {
            button.addEventListener('click', function() {
                categoryButtons.forEach(btn => btn.classList.remove('selected-category'));
                button.classList.add('selected-category');

                const categoryName = button.getAttribute('data-category');
                updateSubCategories(categoryName);
            });
        });

        if (categoryButtons.length > 0) {
            categoryButtons[0].classList.add('selected-category');
            const defaultCategory = categoryButtons[0].getAttribute('data-category');
            updateSubCategories(defaultCategory);
        }
    });
</script>

</body>
</html>